services:
  gateway:
    build:
      context: .
      dockerfile: Gateway/Dockerfile
    ports:
      - "5000:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Docker
      - ASPNETCORE_URLS=http://+:8080
    depends_on:
      - security-agent
      - file-service
    networks:
      - skynet-network

  security-agent:
    build:
      context: .
      dockerfile: SecurityAgent/Dockerfile
    ports:
      - "5001:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Docker
      - ASPNETCORE_URLS=http://+:8080
      - GITHUB_TOKEN=${GITHUB_TOKEN}
    networks:
      - skynet-network

  file-service:
    build:
      context: .
      dockerfile: FileService/Dockerfile
    ports:
      - "5002:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Docker
      - ASPNETCORE_URLS=http://+:8080
    volumes:
      - file-storage:/app/temp-files
    networks:
      - skynet-network

networks:
  skynet-network:
    driver: bridge

volumes:
  file-storage: